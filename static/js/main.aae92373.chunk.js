(this["webpackJsonptimecard-temp"]=this["webpackJsonptimecard-temp"]||[]).push([[0],{163:function(e,t,a){},227:function(e,t){},228:function(e,t){},241:function(e,t,a){},242:function(e,t,a){},243:function(e,t,a){},244:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a(50),r=a.n(c),i=(a(163),a(164),a(27)),o=a(146),l=a(21),s=a(5),u=["children"],d=Object(n.createContext)(),j={auth:!1,empName:null,refetch:0,punches:[{fields:{}}],user:null},b=function(e,t){switch(t.type){case"SET_USER":return Object(l.a)(Object(l.a)({},e),{},{user:t.payload});case"SET_NAME":return Object(l.a)(Object(l.a)({},e),{},{empName:t.payload});case"SET_AUTH":return Object(l.a)(Object(l.a)({},e),{},{auth:t.payload});case"SET_PUNCHES":return Object(l.a)(Object(l.a)({},e),{},{punches:t.payload});case"UPDATE_REFETCH":return Object(l.a)(Object(l.a)({},e),{},{refetch:++e.refetch});default:return Object(l.a)({},e)}},h=function(e){var t=e.children,a=Object(o.a)(e,u),c=Object(n.useReducer)(b,j),r=Object(i.a)(c,2),h=r[0],p=r[1];return Object(s.jsx)(d.Provider,{value:Object(l.a)(Object(l.a)({},h),{},{dispatch:p},a),children:t})},p=function(){return Object(n.useContext)(d)},O=a(259),m=a(258),f=a(257),y=a(245),v=a(55),x=function(){var e=Object(n.useState)(!1),t=Object(i.a)(e,2),a=t[0],c=t[1];return Object(s.jsx)("div",{className:"api_key_container",children:a?Object(s.jsx)(f.a,{type:"text",onChange:function(e){localStorage.api_key=e.target.value,c(!1)}}):Object(s.jsx)("a",{href:"#",onClick:function(){c(!0)},children:"Set API Key"})})},g=a(65),S=a.n(g);var E=function(){var e=Object(n.useState)(""),t=Object(i.a)(e,2),a=t[0],c=t[1],r=p(),o=r.user,l=r.dispatch;return localStorage.auth_until&&+localStorage.auth_until<=Date.now()&&delete localStorage.user,!o&&localStorage.user&&l({type:"SET_USER",payload:localStorage.user}),localStorage.auth_until&&+localStorage.auth_until>Date.now()&&o?(l({type:"SET_AUTH",payload:!0}),Object(s.jsx)(s.Fragment,{children:"Loading"})):Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)(O.a,{className:"Authentication",children:Object(s.jsxs)(m.a,{children:[Object(s.jsxs)(m.a.Field,{children:[Object(s.jsx)("label",{children:"Username"}),Object(s.jsx)(f.a,{placeholder:"Username",onBlur:function(e){return l({type:"SET_USER",payload:e.target.value})}})]}),Object(s.jsxs)(m.a.Field,{children:[Object(s.jsx)("label",{children:"Password"}),Object(s.jsx)(f.a,{type:"password",placeholder:"Password",onChange:function(e){return c(e.target.value)}})]}),Object(s.jsxs)(y.a,{animated:!0,primary:!0,onClick:function(e){e.preventDefault(),new S.a({apiKey:localStorage.api_key}).base("app7hR5UDZ4st97XS")("Employees").select({maxRecords:1,view:"Grid view",fields:["Emp Username","Emp Password","Emp Name"],filterByFormula:"{Emp Username}='".concat(o,"'")}).eachPage((function(e){var t,n,c,r;(null===(t=e[0])||void 0===t||null===(n=t.fields)||void 0===n?void 0:n["Emp Password"])&&(null===(c=e[0])||void 0===c||null===(r=c.fields)||void 0===r?void 0:r["Emp Username"])&&e[0].fields["Emp Password"]===a&&(l({type:"SET_AUTH",payload:!0}),l({type:"SET_NAME",payload:e[0].fields["Emp Name"]}),localStorage.auth_until=Date.now()+36e5,localStorage.user=o)}),(function(e){e&&console.error(e)}))},children:[Object(s.jsx)(y.a.Content,{visible:!0,children:"Submit"}),Object(s.jsx)(y.a.Content,{hidden:!0,children:Object(s.jsx)(v.a,{name:"arrow right"})})]})]})}),Object(s.jsx)(x,{})]})},T=a(144),P=function(e){var t=e.inOut,a=p(),c=a.user,r=a.dispatch,o=Object(n.useState)(!1),l=Object(i.a)(o,2),u=l[0],d=l[1];return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)(y.a,{primary:"In"===t,secondary:"Out"===t,onClick:function(){d(!0),navigator.geolocation.getCurrentPosition((function(e){var a=e.coords,n=a.latitude,i=a.longitude,o=e.timestamp;new S.a({apiKey:localStorage.api_key}).base("app7hR5UDZ4st97XS")("Punch Times").create([{fields:{Username:c,"Punch Time":o,"Punch Latitude":n,"Punch Longitude":i,"Punch Type":t}}],(function(e){if(e)return alert(e);r({type:"UPDATE_REFETCH",payload:!0}),d(!1)}))}),(function(e){console.log(e),alert('Please "Allow" location services for this site.')}),{maximumAge:1e4,timeout:5e3,enableHighAccuracy:!0})}.bind(undefined,t),disabled:u,children:["Clock ",t]})})};a(241);var _=function(e){var t=e.inOutNext;return Object(s.jsx)("div",{className:"DayGroup",children:Object(s.jsx)(P,{inOut:t})})};a(242);var w=function(){var e,t=Object(n.useState)(!1),a=Object(i.a)(t,2),c=a[0],r=a[1],o=p(),l=o.empName,u=o.punches,d=o.refetch,j=o.user,b=o.dispatch;return Object(n.useEffect)((function(){new S.a({apiKey:localStorage.api_key}).base("app7hR5UDZ4st97XS")("Punch Times").select({maxRecords:20,view:"Grid view",sort:[{field:"ID",direction:"desc"}],filterByFormula:'AND(Username = "'.concat(j,'")')}).eachPage((function(e,t){r(!0),b({type:"SET_PUNCHES",payload:e}),t()}),(function(e){e&&console.error(e)}))}),[d,j,b]),Object(s.jsxs)("div",{className:"TimeCard",children:[Object(s.jsxs)("h2",{children:["Hello, ",null===l||void 0===l?void 0:l.split(" ")[0]]}),c?Object(s.jsx)(_,{inOutNext:"In"===(null===(e=u[0])||void 0===e?void 0:e.fields["Punch Type"])?"Out":"In"}):"Loading...",Object(s.jsx)("br",{}),null===u||void 0===u?void 0:u.map((function(e,t){return Object(s.jsxs)("div",{className:"TimeCard-TimeBlock",children:["".concat(T.DateTime.fromISO(e.fields["Punch Time"]).toFormat("MM-dd-yyyy HH:mm")," (").concat(e.fields["Punch Type"],")"),Object(s.jsx)("hr",{})]},t)}))]})},C=function(){var e=p().auth;return Object(s.jsx)(s.Fragment,{children:e?Object(s.jsx)(w,{}):Object(s.jsx)(E,{})})};a(243);var U=function(){return Object(s.jsx)(h,{children:Object(s.jsx)(C,{})})},N=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,261)).then((function(t){var a=t.getCLS,n=t.getFID,c=t.getFCP,r=t.getLCP,i=t.getTTFB;a(e),n(e),c(e),r(e),i(e)}))};r.a.render(Object(s.jsx)(U,{}),document.getElementById("root")),N()}},[[244,1,2]]]);
//# sourceMappingURL=main.aae92373.chunk.js.map